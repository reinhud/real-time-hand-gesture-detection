"""Implementation of general training loop."""